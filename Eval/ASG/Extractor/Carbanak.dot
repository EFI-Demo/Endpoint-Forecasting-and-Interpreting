digraph "Carbanak.dot" {
rankdir="LR"
size="9"
fixedsize="false"
splines="true"
nodesep=0.3
ranksep=0
fontsize=10
overlap="scalexy"
engine= "neato"
	"'itself'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'Carbanak'" -> "'itself'" [label="1: write"]
	"'into \" * \\com \"'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'Carbanak'" -> "'into \" * \\com \"'" [label="2: write"]
	"'svchost.exe'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'Carbanak'" -> "'svchost.exe'" [label="3: write"]
	"'with the file attributes : system , hidden and read - only'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'Carbanak'" -> "'with the file attributes ":" system , hidden and read - only'" [label="4: write"]
	"'a file with a random name and a .bin extension in * \\Mozilla where it stores commands to be executed'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'Carbanak'" -> "'a file with a random name and a .bin extension in * \\Mozilla where it stores commands to be executed'" [label="8: write"]
	"'commands to be executed'" [node_type=file shape=ellipse]
	"'in *'" [node_type=Process shape=box]
	"'in *'" -> "'commands to be executed'" [label="9: write"]
	"'commands to be executed'" [node_type=file shape=ellipse]
	"'where'" [node_type=Process shape=box]
	"'where'" -> "'commands to be executed'" [label="10: write"]
	"'commands to be executed'" [node_type=file shape=ellipse]
	"'it'" [node_type=Process shape=box]
	"'it'" -> "'commands to be executed'" [label="11: write"]
	"'the proxy configuration'" [node_type=file shape=diamond]
	"'the malware'" [node_type=Process shape=box]
	"'the proxy configuration'" -> "'the malware'" [label="12: receive"]
	"'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internetentry'" [node_type=file shape=diamond]
	"'the malware'" [node_type=Process shape=box]
	"'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internetentry'" -> "'the malware'" [label="13: receive"]
	"'\\Mozilla\\Firefox\\ProfileName\\prefs.js'" [node_type=file shape=diamond]
	"'the malware'" [node_type=Process shape=box]
	"'\\Mozilla\\Firefox\\ProfileName\\prefs.js'" -> "'the malware'" [label="14: receive"]
	"'proxy configuration information'" [node_type=file shape=ellipse]
	"'Additionally'" [node_type=Process shape=box]
	"'proxy configuration information'" -> "'Additionally'" [label="15: 'read'"]
	"'/-application-/'" [node_type=file shape=ellipse]
	"'Additionally'" [node_type=Process shape=box]
	"'/-application-/'" -> "'Additionally'" [label="16: 'read'"]
	"'proxy configuration information'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'proxy configuration information'" -> "'Carbanak'" [label="17: 'read'"]
	"'/-application-/'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'/-application-/'" -> "'Carbanak'" [label="18: 'read'"]
	"'through an application'" [shape=diamond]
	"'headers'" [shape=box]
	"'headers'" -> "'through an application'" [label="19: send"]
	"'via SOCKS or HTTP'" [shape=diamond]
	"'headers'" [shape=box]
	"'headers'" -> "'via SOCKS or HTTP'" [label="20: send"]
	"'Carbanak'" [node_type=Process shape=box]
	".*\Carbanak code" [node_type=File shape=ellipse]
	"'Carbanak'" -> ".*\Carbanak code" [label="21: exec"]
	"'Carbanak'" [node_type=Process shape=box]
	".*\svchost.exe" [node_type=File shape=ellipse]
	"'Carbanak'" -> ".*\svchost.exe" [label="22: exec"]
	"'below'" [node_type=file shape=ellipse]
	"'the actions'" [node_type=file shape=ellipse]
	"the actions" -> below [label="23: describe"]
	"'kldconfig.pl'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'kldconfig.pl'" -> "'Carbanak'" [label="24: 'read'"]
	"'by the exploit payload'" [node_type=file shape=ellipse]
	"'The original file'" [node_type=Process shape=box]
	"'The original file'" -> "'by the exploit payload'" [label="25: write"]
	"'the names of the processes to be monitored'" [node_type=file shape=ellipse]
	"'The original file created by the exploit payload'" [node_type=file shape=ellipse]
	"The original file created by the exploit payload" -> "the names of the processes to be monitored" [label="26: include"]
	"'by the exploit payload'" [node_type=file shape=ellipse]
	"'The original'" [node_type=Process shape=box]
	"'The original'" -> "'by the exploit payload'" [label="27: write"]
	"'the executable code in memory'" [node_type=file shape=ellipse]
	"'after executing this service'" [node_type=Process shape=box]
	"'after executing this service'" -> "'the executable code in memory'" [label="28: write"]
	"'in order to establish simultaneous work processes for both remote and local users'" [node_type=file shape=ellipse]
	"'after executing this service'" [node_type=Process shape=box]
	"'after executing this service'" -> "'in order to establish simultaneous work processes for both remote and local users'" [label="29: write"]
	"'the executable code in memory'" [node_type=file shape=ellipse]
	"'The original file created by the exploit payload'" [node_type=Process shape=box]
	"'The original file created by the exploit payload'" -> "'the executable code in memory'" [label="30: write"]
	"'in order to establish simultaneous work processes for both remote and local users'" [node_type=file shape=ellipse]
	"'The original file created by the exploit payload'" [node_type=Process shape=box]
	"'The original file created by the exploit payload'" -> "'in order to establish simultaneous work processes for both remote and local users'" [label="31: write"]
	"'simultaneous work processes for both remote and local users'" [node_type=file shape=ellipse]
	"'The original file created by the exploit payload'" [node_type=file shape=ellipse]
	"The original file created by the exploit payload" -> "simultaneous work processes for both remote and local users" [label="32: establish"]
	"'in this process'" [node_type=file shape=ellipse]
	"'Modules'" [node_type=Process shape=box]
	"'Modules'" -> "'in this process'" [label="33: write"]
	"'termsrv.dll'" [node_type=file shape=ellipse]
	"'Modules modified in this process'" [node_type=file shape=ellipse]
	"Modules modified in this process" -> "termsrv.dll" [label="34: be"]
	"'csrsrv.dll'" [node_type=file shape=ellipse]
	"'Modules modified in this process'" [node_type=file shape=ellipse]
	"Modules modified in this process" -> "csrsrv.dll" [label="35: be"]
	"'msgina.dll'" [node_type=file shape=ellipse]
	"'Modules modified in this process'" [node_type=file shape=ellipse]
	"Modules modified in this process" -> "msgina.dll" [label="36: be"]
	"'winlogon.exe'" [node_type=file shape=ellipse]
	"'Modules modified in this process'" [node_type=file shape=ellipse]
	"Modules modified in this process" -> "winlogon.exe" [label="37: be"]
	"'/-application-/'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'/-application-/'" -> "'Carbanak'" [label="45: 'read'"]
	"'in the infected computer'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'in the infected computer'" -> "'Carbanak'" [label="46: 'read'"]
	"'/-application-/'" [node_type=file shape=ellipse]
	"'/-application-/'" [node_type=Process shape=box]
	"'/-application-/'" -> "'/-application-/'" [label="47: 'read'"]
	"'in the infected computer'" [node_type=file shape=ellipse]
	"'/-application-/'" [node_type=Process shape=box]
	"'in the infected computer'" -> "'/-application-/'" [label="48: 'read'"]
	"'a special notification'" [shape=diamond]
	"'in the infected computer'" [shape=box]
	"'in the infected computer'" -> "'a special notification'" [label="49: send"]
	"'to Carbanak'" [shape=diamond]
	"'in the infected computer'" [shape=box]
	"'in the infected computer'" -> "'to Carbanak'" [label="50: send"]
	"'/-application-/'" [node_type=file shape=ellipse]
	"'a special notification to Carbanak'" [node_type=Process shape=box]
	"'/-application-/'" -> "'a special notification to Carbanak'" [label="51: 'read'"]
	"'in the infected computer'" [node_type=file shape=ellipse]
	"'a special notification to Carbanak'" [node_type=Process shape=box]
	"'in the infected computer'" -> "'a special notification to Carbanak'" [label="52: 'read'"]
	"'remote'" [node_type=file shape=ellipse]
	"'a special notification to Carbanak'" [node_type=Process shape=box]
	"'remote'" -> "'a special notification to Carbanak'" [label="53: 'read'"]
	"'To communicate with its remote ip'" [node_type=Process shape=box]
	".*\the HTTP protocol" [node_type=File shape=ellipse]
	"'To communicate with its remote ip'" -> ".*\the HTTP protocol" [label="54: exec"]
	"'To communicate with its remote ip'" [node_type=Process shape=box]
	".*\with Rremote ip:*+Base64 encryption" [node_type=File shape=ellipse]
	"'To communicate with its remote ip'" -> ".*\with Rremote ip":"*+Base64 encryption" [label="55: exec"]
	"'To communicate with its remote ip'" [node_type=Process shape=box]
	".*\adding additional characters not included in Base64" [node_type=File shape=ellipse]
	"'To communicate with its remote ip'" -> ".*\adding additional characters not included in Base64" [label="56: exec"]
	"'Carbanak'" [node_type=Process shape=box]
	".*\the HTTP protocol" [node_type=File shape=ellipse]
	"'Carbanak'" -> ".*\the HTTP protocol" [label="57: exec"]
	"'Carbanak'" [node_type=Process shape=box]
	".*\with Rremote ip:*+Base64 encryption" [node_type=File shape=ellipse]
	"'Carbanak'" -> ".*\with Rremote ip":"*+Base64 encryption" [label="58: exec"]
	"'Carbanak'" [node_type=Process shape=box]
	".*\adding additional characters not included in Base64" [node_type=File shape=ellipse]
	"'Carbanak'" -> ".*\adding additional characters not included in Base64" [label="59: exec"]
	"'additional characters not included in Base64'" [node_type=file shape=ellipse]
	"'Carbanak'" [node_type=Process shape=box]
	"'Carbanak'" -> "'additional characters not included in Base64'" [label="60: write"]
	"\"fake transactions in the victim 's internal database\"" [node_type=file shape=ellipse]
	"'Attackers'" [node_type=Process shape=box]
	"'Attackers'" -> "\"fake transactions in the victim 's internal database\"" [label="61: write"]
	"'after this process'" [node_type=file shape=ellipse]
	"'Attackers'" [node_type=Process shape=box]
	"'Attackers'" -> "'after this process'" [label="62: write"]
	"'thus avoiding discovery of the fraudulent'" [node_type=file shape=ellipse]
	"'Attackers'" [node_type=Process shape=box]
	"'Attackers'" -> "'thus avoiding discovery of the fraudulent'" [label="63: write"]
	"'discovery of the fraudulent'" [node_type=file shape=ellipse]
	"'Attackers'" [node_type=file shape=ellipse]
	Attackers -> "discovery of the fraudulent" [label="66: avoid"]
	"'discovery of the fraudulent'" [node_type=file shape=ellipse]
	"'thus'" [node_type=file shape=ellipse]
	thus -> "discovery of the fraudulent" [label="67: avoid"]
	"'Attackers'" [node_type=Process shape=box]
	".*\the victim 's internal command utilities" [node_type=File shape=ellipse]
	"'Attackers'" -> ".*\the victim 's internal command utilities" [label="68: exec"]
	"'Attackers'" [node_type=Process shape=box]
	".*\to insert fraudulent operations in the transaction queue" [node_type=File shape=ellipse]
	"'Attackers'" -> ".*\to insert fraudulent operations in the transaction queue" [label="69: exec"]
	"'fraudulent operations'" [node_type=file shape=ellipse]
	"'Attackers'" [node_type=file shape=ellipse]
	Attackers -> "fraudulent operations" [label="71: insert"]
	"'in the transaction queue'" [node_type=file shape=ellipse]
	"'Attackers'" [node_type=file shape=ellipse]
	Attackers -> "in the transaction queue" [label="72: insert"]
}
