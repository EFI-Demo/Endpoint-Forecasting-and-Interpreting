digraph "T1098.001" {
rankdir="LR"size="9"fixedsize="false"splines="true"nodesep=0.3ranksep=0fontsize=10overlap="scalexy"engine= "neato"
	"mal1_P" [node_type=Process shape=box]
	"mal2_P" [node_type=Process shape=box]
	"Import-Module_P" [node_type=Process shape=box]
	"ConvertTo-SecureString1_P" [node_type=Process shape=box]
	"New-Object1_P" [node_type=Process shape=box]
	"Connect-AzureAD1_P" [node_type=Process shape=box]
	"mal3_P" [node_type=Process shape=box]
	"Get-AzureADServicePrincipal_P" [node_type=Process shape=box]
	"Get-Date_P" [node_type=Process shape=box]
	"New-SelfSignedCertificate_P" [node_type=Process shape=box]
	"ConvertTo-SecureString2_P" [node_type=Process shape=box]
	"Export-PfxCertificate_P" [node_type=Process shape=box]
	"mal4_P" [node_type=Process shape=box]
	"New-Object2_P" [node_type=Process shape=box]
	"ToBase64String_P" [node_type=Process shape=box]
	"mal5_P" [node_type=Process shape=box]
	"New-AzureADServicePrincipalKeyCredential_P" [node_type=Process shape=box]
	"mal6_P" [node_type=Process shape=box]
	"Start-Sleep_P" [node_type=Process shape=box]
	"Get-AzureADTenantDetail_P" [node_type=Process shape=box]
	"Connect-AzureAD2_P" [node_type=Process shape=box]
	"$env TEMP\\SuperSP.pfx_F3" [node_type=File shape=ellipse]
	"mal1_P" -> "mal2_P" [label="1: fork"]
	"mal2_P" -> "Import-Module_P" [label="2: fork"]
	"mal2_P" -> "ConvertTo-SecureString1_P" [label="3: fork"]
	"mal2_P" -> "New-Object1_P" [label="4: fork"]
	"mal2_P" -> "Connect-AzureAD1_P" [label="5: fork"]
	"mal1_P" -> "mal3_P" [label="6: fork"]
	"mal3_P" -> "Get-AzureADServicePrincipal_P" [label="7: fork"]
	"mal3_P" -> "Get-Date_P" [label="8: fork"]
	"mal3_P" -> "New-SelfSignedCertificate_P" [label="9: fork"]
	"mal3_P" -> "ConvertTo-SecureString2_P" [label="10: fork"]
	"mal3_P" -> "Export-PfxCertificate_P" [label="11: fork"]
	"Export-PfxCertificate_P" -> "$env TEMP\\SuperSP.pfx_F3" [label="12: write"]
	"mal1_P" -> "mal4_P" [label="13: fork"]
	"mal4_P" -> "New-Object2_P" [label="14: fork"]
	"New-Object2_P" -> "$env TEMP\\SuperSP.pfx_F3" [label="15: read"]
	"mal4_P" -> "ToBase64String_P" [label="16: fork"]
	"mal1_P" -> "mal5_P" [label="17: fork"]
	"mal5_P" -> "New-AzureADServicePrincipalKeyCredential_P" [label="18: fork"]
	"mal1_P" -> "mal6_P" [label="19: fork"]
	"mal6_P" -> "Start-Sleep_P" [label="20: fork"]
	"mal6_P" -> "Get-AzureADTenantDetail_P" [label="21: fork"]
	"mal6_P" -> "Connect-AzureAD2_P" [label="22: fork"]
}
